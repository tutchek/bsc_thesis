%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                    %%%
%%% ©ablona bakaláøské práce na MFF UK %%%
%%%                                    %%%
%%% (c) Franti¹ek ©trupl, 2005         %%%
%%%                                    %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% POZOR: Úprava bakaláøské práce je závislá rovnì¾ na volbì jednostranného resp. oboustranného tisku.
%%%        Bli¾¹i informace naleznete v dokumentu Úprava bakaláøské práce, který se nalézá na adrese:
%%%        http://www.mff.cuni.cz/studium/obecne/bplayout/pok12mo4.pdf

\documentclass[12pt,notitlepage]{report}
%\pagestyle{headings}
\pagestyle{plain}

% \frenchspacing % aktivuje pou¾ití nìkterých èeských typografických pravidel

\usepackage[latin2]{inputenc} % nastavuje pou¾ité kódování, u¾ivatelé Windows zamìní latin2 za cp1250
%\usepackage{czech}
\usepackage{a4wide} % nastavuje standardní evropský formát stránek A4
%\usepackage{index} % nutno pou¾ít v pøípadì tvorby rejstøíku balíèkem makeindex
%\usepackage{fancybox} % umo¾òuje pokroèilé rámeèkování :-)
%\usepackage{natbib}
\usepackage{graphicx} % nezbytné pro standardní vkládání obrázkù do dokumentu

\usepackage{chessboard}

\usepackage{amsmath}

\usepackage[left=4cm]{geometry} % nastavení dané velikosti okrajù

%\newindex{default}{idx}{ind}{Rejstøík} % zavádí rejstøík v pøípadì pou¾ití balíku index

\usepackage{nomencl}
\makenomenclature  


\title{Constraint solvers}   % tyto dvì polo¾ky jsou zde v podstatì formálnì, ve skuteènosti nejsou nikde 
\author{Michal Tuláèek} % dále v dokumentu pou¾ity

%\date{}

\begin{document}

\newcommand{\zkratka}[2]{{#1}\nomenclature{#1}{#2}}

\newcommand{\mand}{\wedge}
\newcommand{\mor}{\vee}

%\csprimeson % zapne jednoduché psaní èeských uvozovek pomocí klasických znakù, ale potom pozor 
             % na originální apostrofy, které budou chybnì interpretovány!!!

%%% Následuje první, úvodní, strana bakaláøské práce. Jednotlivé polo¾ky nahraïte dle vlastních
%%% údajù. Zmìnit podle konkrétní délky jednotlivých polo¾ek mù¾ete i zalomení øádkù.
\begin{titlepage}
\begin{center}
\ \\

\vspace{15mm}

\large
Charles University in Prague\\
Faculty of Mathematics and Physics\\

\vspace{5mm}

{\Large\bf BACHELOR THESIS}

\vspace{10mm}

%%% Aby vlo¾ní loga v¹e správnì fungovalo, je tøeba mít soubor logo.eps nahraný v pracovním adresáøi,
%%% tj. v adresáøi, kde se nachází pøekládaný zdrojový soubor. Soubor logo.eps je mo¾né získat napø.
%%% na adrese: http://www.mff.cuni.cz/fakulta/symboly/logo.eps
\includegraphics[scale=0.3]{logo.eps} 

\vspace{15mm}

%\normalsize
{\Large Michal Tuláèek}\\ % doplòte va¹e jméno
\vspace{5mm}
{\Large\bf Constraint solvers}\\ % doplòte název práce
\vspace{5mm}
Department of Theoretical Computer Science and Mathematical Logic\\ % doplòte název katedry èi ústavu
\end{center}
\vspace{15mm}

\large
\noindent Supervisor: Doc. RNDr. Roman Barták, Ph.D. % doplòte odpovídající údaje
%%% dal¹í øádek mù¾ete ve vìt¹inì pøípadù (tj. pokud údaje uvedené vý¹e nejsou pøíli¹ dlouhé) zru¹it
\hskip20mm    
\vspace{1mm} 

\noindent Study programme: General Informatics % doplòte odpovídající údaje
%%% dal¹í øádek mù¾ete ve vìt¹inì pøípadù (tj. pokud údaje uvedené vý¹e nejsou pøíli¹ dlouhé) zru¹it
\hskip20mm 


\begin{center}
2008 % doplòte rok vzniku va¹í bakaláøské práce

\begin{verbatim}
$Id$
\end{verbatim}
\end{center}

\end{titlepage} % zde konèí úvodní strana

\normalsize % nastavení normální velikosti fontu
\setcounter{page}{2} % nastavení èíslování stránek
\ \vspace{10mm} 

\noindent I wish to thank my supervisor Dr. R. Barták for advices and patience. My thanks also belongs to V. Kopal who helped me (v tuhle chvíli mám pouze slib :D) with correction of the english text.  

\vspace{\fill} % nastavuje dynamické umístìní následujícího textu do spodní èásti stránky
\noindent Prohla¹uji, ¾e jsem svou bakaláøskou práci napsal(a) samostatnì a výhradnì s pou¾itím citovaných pramenù. Souhlasím se zapùjèováním práce a jejím zveøejòováním.

\vspace{10mm}

\noindent I declare that I wrote my bachelor thesis independently and exclusively with the use of the cited sources. I agree with lending this thesis.

\bigskip
\noindent In Prague, 24th February 2007 \hspace{\fill}Michal Tuláèek\\ % doplòte patøièné datum, jméno a pøíjmení

%%%   Výtisk pak na tomto míste nezapomeòte PODEPSAT!
%%%                                         *********

\tableofcontents % vkládá automaticky generovaný obsah dokumentu

\newpage % pøechod na novou stránku

%%% Následuje strana s abstrakty. Doplòte vlastní údaje.
\noindent
Název práce: Øe¹ièe omezujících podmínek\\
Autor: Michal Tuláèek\\
Katedra (ústav): Katedra teoretické informatiky a matematické logiky\\
Vedoucí bakaláøské práce: Doc. RNDr. Roman Barták, Ph.D.\\
e-mail vedoucího: bartak@kti.mff.cuni.cz\\

\noindent Abstrakt: Øe¹iè omezujících podmínek je specializovaný software, urèený k øe¹ení problémù popsaných omezujícími podmínkami. Práce podává pøehled øe¹ièù a vybrané z nich testuje a srovnává. \\

\noindent Klíèová slova: omezující podmínky, øe¹ièe, benchmarky

\vspace{10mm}

\noindent
Title: Constraint solvers\\
Author: Michal Tuláèek\\
Department: Department of Theoretical Computer Science and Mathematical Logic\\
Supervisor: Doc. RNDr. Roman Barták, Ph.D.\\
Supervisor's e-mail address: bartak@kti.mff.cuni.cz\\

\noindent Abstract: Constraint solver is specialized software used to solve constraint satisfaction problems. Work lists solvers and some of them tests and compare. \\

\noindent Keywords: constraint satisfaction problems, constraint solvers, benchmark

\newpage

%%% Následuje text bakaláøské práce èlenìný do kapitol, které se èíslují, oznaèí názvy a graficky oddìlí.
%%% Nedoporuèuje se pou¾ívat víc ne¾ dvì úrovnì èíslování kapitol, viz pøíklad ní¾e.

\chapter{Introducion}

\section{Goal of the thesis}
Constraint satisfaction is relatively new field of computer science which focus on the problems
which can be described by some constraints. As an example of constraint one can imagine logical dependencies 
(A is valid only if B is invalid), arithmetical constraints ($X = 8 + Y + Z$) and lots of more. Real life situations can 
be as well described with constraints, e.g. worker Smith cannot work with worker Adams, also he can work only 
on monday and tuesday and cannot work in the night shift. These constraints together defines whole
complex problem -- a Constraint Satisfaction Problem (\zkratka{CSP}{Constraint Satisfaction Problem}).
Further examples of CSP can be found in \cite{csplib} and \cite{Apt2003}.

There are many techiques how to solve CSP. One can use his own ad hoc created solution. 
Or there is availability of using some standard constraint solver. This solver expect
as an input description of problem and returns solution if some exists. There is many 
of these systems and this thesis pick some of them and test them in various aspects.
More complex list of solvers and other CSP related software is in \cite{bartak:los}.

The aspects which are studied are modelling capabilities, time and space efficiency, 
integration with other programming environments, development environment and debugging features. 

\section{Structure of the thesis}

In the second chapter we will study six solvers. All but one are open source solvers. 
The only commercial system is SICstus Prolog. ECLiPSE and SICstus Prolog are based on Prolog
programming language, Mozart on Oz language, Choco is a Java library, Gecode is based on C++ and finally 
minion is based on C language. Minion can be also used as standalone solver - in this 
case it provides its own language for definition of problems.

In the the third chapter we will define benchmarks and explain what the benchmarks
should show on the systems.

Fourth chapter contains detailed results of the benchmarks and finally in fifth chapter 
we will make some conclusions about the results.

\chapter{Constraint solvers}

\section{ECLiPSe}

\subsection{Description}

ECLiPSe is open source constraint satisfaction solving system based on Prolog 
programming language. It is available for Microsoft Windows NT family, 
Linux 32bit/64bit, MacOS and SunOS Sparc platforms. The system is based on the Prolog programming
language which is extended bz new predicates and operators. Prolog extensions are 
more described in "Modelling Capabilities" subsection. In general it can be said that ECLiPSe
system tends to be SICStus Prolog compatible. ECLiPSe provides grafical interface,
methods to communicate with hosting operating system or via network. 

As stated in \cite{wiki:Eclipse} ECLiPSe is developed until 1995 at the European 
Computer-Industry Research Centre in Munich and then until 2005 at the Centre for 
Planning and Resource Control at Imperial College London. It is currently copyrighted by 
Cisco Systems. In September 2006, it was released as open source software under 
the Cisco Systems|Cisco-style MPL, equivalent to the Mozilla Public License.

In the time of writing this thesis it is available in version 5.10 which is benchmarked.


\subsection{Modelling capabilities}



\subsection{Efficiency}

aa

\subsection{Programming support features}

aa


\section{SICStus Prolog}

\subsection{Short description}

aa

\subsection{History}

aa

\subsection{Modelling capabilities}

aa

\subsection{Efficiency}

aa

\subsection{Programming support features}

aa


\section{Gecode}

\subsection{Short description}

aa

\subsection{History}

aa

\subsection{Modelling capabilities}

aa

\subsection{Efficiency}

aa

\subsection{Programming support features}

aa


\section{Choco}

\subsection{Short description}

aa

\subsection{History}

aa

\subsection{Modelling capabilities}

aa

\subsection{Efficiency}

aa

\subsection{Programming support features}

aa


\section{Mozart}

\subsection{Short description}

aa

\subsection{History}

aa

\subsection{Modelling capabilities}

aa

\subsection{Efficiency}

aa

\subsection{Programming support features}

aa


\section{Minion}

\subsection{Description}

Minion is very low level CSP system with strictly limited set of commands. One 
can describe programming in minion as "constraint satisfaction machine language".
As an example we can demonstrate in on the 4-queens problem.

Common description is:

\begin{align}
\forall i,j, i \neq j & : Q_i \neq Q_j \\
\forall i,j, i < j & : | Q_i - Q_j | \neq j - i 
\end{align}

However in minion there has to be twelve auxiliary variables. Minion does not 
support "sum is equal". If user want to achieve "sum is equal" constraint it has 
to be modified from


Also there is nothing like for or while cycles, whole problem has to be defined in
the input file, which makes programming in pure minion really difficult and nearly
impossible to scale because of growing of auxiliary variables.

The 4-queen problem then looks as follows

\begin{equation*}
\begin{gathered}
Q_2 - Q_3 \leq a_0 \\
Q_1 - Q_3 \leq a_2 \\
Q_1 - Q_2 \leq a_4 \\
Q_0 - Q_3 \leq a_6 \\
Q_0 - Q_2 \leq a_8 \\
Q_0 - Q_1 \leq a_{10}
\end{gathered} \qquad \begin{gathered}
Q_2 - Q_3 \geq a_0 \\
Q_1 - Q_3 \geq a_2 \\
Q_1 - Q_2 \geq a_4 \\
Q_0 - Q_3 \geq a_6 \\
Q_0 - Q_2 \geq a_8 \\
Q_0 - Q_1 \geq a_{10}
\end{gathered} \qquad \begin{gathered}
| a_0 | = a_1 \\
| a_2 | = a_3 \\
| a_4 | = a_5 \\
| a_6 | = a_7 \\
| a_8 | = a_9 \\
| a_{10} | = a_{11}
\end{gathered} \qquad \begin{gathered}
a_{11} \neq 1 \\
a_9 \neq 2 \\
a_7 \neq 3 \\
a_5 \neq 3 \\
a_1 \neq 1 \\
\text{alldifferent}(Q_1,Q_2,Q_3,Q_4)
\end{gathered}
\end{equation*}

As one can see, the problem is described strictly for four queens variant. If there is 
need to extend number of queens whole problem description has to be rewriten.

Fortunately there exists java program Tailor by Andrea Rendl. Tailor converts program
written in Essence' programming language to input format of Minion. Essence' is solver
independent language which can  

\subsection{Modelling capabilities}

aa

\subsection{Efficiency}

aa

\subsection{Programming support features}

aa


\chapter{Benchmarks}

In this chapter we will define the benchmark which are used. Several of them were
used in \cite{fernandez00} and others can be found at CSPLib \cite{csplib}.

\section{Self Referential Quiz}
\zkratka{SRQ}{Self Referential Quiz} was used in \cite{fernandez00}. We will use it to show how the solvers
evolved since year 2000. The quiz consist from ten questions whose answers depends
one on another.

\begin{enumerate}
	\item\label{q1} The first question whose answer is A is: (A) \ref{q4} (B) \ref{q3} (C) \ref{q2} (D) \ref{q1} (E) none of above
	\item\label{q2} The only two consecutive questions with identical answers are: (A) \ref{q3} and \ref{q4} (B) \ref{q4} and \ref{q5} (C) \ref{q5} and \ref{q6} (D) \ref{q6} and \ref{q7} (E) \ref{q7} and \ref{q8}
	\item\label{q3} The next question with answer A is: (A) \ref{q4} (B) \ref{q5} (C) \ref{q6} (D) \ref{q7} (E) \ref{q8}
	\item\label{q4} The first even numbered question with answer B is: (A) \ref{q2} (B) \ref{q4} (C) \ref{q6} (D) \ref{q8} (E) \ref{q10} 
	\item\label{q5} The only odd numbered question with answer C is: (A) \ref{q1} (B) \ref{q3} (C) \ref{q5} (D) \ref{q7} (E) \ref{q9}
	\item\label{q6} A question with answer D: (A) comes before this one, but not after this one (B) comes after this one, but not before this one (C) comes before and after this one (D) does not occur at all (E) none of the above
	\item\label{q7} The last question whose answer is E is: (A) \ref{q5} (B) \ref{q6} (C) \ref{q7} (D) \ref{q8} (E) \ref{q9}
	\item\label{q8} The number of questions whose answers are consonants is: (A) 7 (B) 6 (C) 5 (D) 4 (E) 3
	\item\label{q9} The number of questions whose answers are vowels is: (A) 0 (B) 1 (C) 2 (D) 3 (E) 4
	\item\label{q10} The answer to this question is: (A) A (B) B (C) C (D) D (E) E
	
\end{enumerate} 

This quiz can be represented as fifty boolean variables $Q_{ij}$, $i \in \{1,\dots,10\}$, 
$j \in \{A,\dots,B\}$ where $Q_{ij}$ is 1 if, and only if question $i$ has answer $j$.
Otherwise $Q_{ij} = 0$. Representation of the SRQ as Satisfability problem with fifty 
boolean variables and corresponding program in Oz is shown in \cite{Henz96}. We 
will demonstrate here only first question.

\begin{align}
Q_{1A} &\equiv \neg Q_{1A} \mand \neg Q_{2A} \mand \neg Q_{3A} \mand Q_{4A}  \\
Q_{1B} &\equiv \neg Q_{1A} \mand \neg Q_{2A} \mand Q_{3A}  \\
Q_{1C} &\equiv \neg Q_{1A} \mand Q_{2A} \\
Q_{1D} &\equiv Q_{1A}  \\
Q_{1E} &\equiv \neg Q_{1A} \mand \neg Q_{2A} \mand \neg Q_{3A} \mand \neg Q_{4A}
\end{align}

And constraint ensuring that there is only one answer to this question.

$$(Q_{1A} \mand \neg Q_{1B} \mand \neg Q_{1C} \mand \neg Q_{1D} \mand \neg Q_{1E}) \mor (\neg Q_{1A} \mand  Q_{1B} \mand \neg Q_{1C} \mand \neg Q_{1D} \mand \neg Q_{1E}) \mor $$
$$(\neg Q_{1A} \mand \neg Q_{1B} \mand  Q_{1C} \mand \neg Q_{1D} \mand \neg Q_{1E}) \mor (\neg Q_{1A} \mand \neg Q_{1B} \mand \neg Q_{1C} \mand  Q_{1D} \mand \neg Q_{1E}) \mor $$
$$(\neg Q_{1A} \mand \neg Q_{1B} \mand \neg Q_{1C} \mand \neg Q_{1D} \mand  Q_{1E}) \mor $$

This constraint can be simplified to

$$Q_{1A} + Q_{1B} + Q_{1C} + Q_{1D} + Q_{1E} = 1$$

The SRQ can be also specified as problem with ten variables $Q_i = j$, $i \in \{1,\dots,10\}$, $j \in \{1,\dots,5\}$
where $Q_i = 1$ means answer to question $i$ is A and so on. First question will
in that case be:

\begin{align}
Q_1 = 1 &\Leftrightarrow (\forall i < 4)(Q_i \neq 1) \mand (Q_i = 4)
\end{align}

\begin{figure}
\begin{center}
\begin{tabular}{cc}
\begin{tabular}{|c|c|c|c|c|c|}
\hline	 &	A	&	B	&	C	&	D & E \\
\hline 1	 &	0	&	0	&	1	&	0 & 0 \\
\hline 2	 &	1	&	0	&	0	&	0 & 0 \\
\hline 3	 &	0	&	1	&	0	&	0 & 0 \\
\hline 4	 &	0	&	1	&	0	&	0 & 0 \\
\hline 5	 &	1	&	0	&	0	&	0 & 0 \\
\hline 6	 &	0	&	1	&	0	&	0 & 0 \\
\hline 7	 &	0	&	0	&	0	&	0 & 1 \\
\hline 8	 &	0	&	1	&	0	&	0 & 0 \\
\hline 9	 &	0	&	0	&	0	&	0 & 1 \\
\hline 10 &	0	&	0	&	0	&	1 & 0 \\
\hline
\end{tabular} & \begin{tabular}{|c|c|c|c|c|c|}
\hline	   &	Q \\
\hline 1	 &	3 \\
\hline 2	 &	1 \\
\hline 3	 &	2 \\
\hline 4	 &	2 \\
\hline 5	 &	1 \\
\hline 6	 &	2 \\
\hline 7	 &	5 \\
\hline 8	 &	2 \\
\hline 9	 &	5 \\
\hline 10  &	4 \\
\hline
\end{tabular}
\end{tabular}
\end{center}
\caption{Solutions of SRQ represented by 50 boolean or 10 finite domain variables.}
\label{table.SRQsolution}
\end{figure}

\section{N queens}

Problem of the $N$ queens is classic chess excercise. The task is to place $N$ queens 
on the $N \times N$ chessboard so that none of them can hit any other. Queen attacks
figures in the same column and row as it stands. Also it attacks figures on diagonal fields.

We have to place $N$ queens on chessboard $N \times N$ so there 

\def\mylist{Ke1, qe2, kf3}
\setchessboard{setpieces=\mylist}
\def\mylist{qa1, qb5, qc8, qd6, qe3, qf7, qg2, qh4}
\chessboard  

\section{Random CSP}

%%  Náhodnì generovaný binární problém splòování podmínek.
%%  Dnes nejbì¾nìj¹í benchmark.
%%  Problém je charakterizován ètveøicí <n,m,p1,p2>
%%   n je poèet promìnných
%%   m je velikost domén (v¹echny promìnné mají stejnou doménu)
%%   p1 je hustota (density) podmínek
%%   p2 je uta¾enost (tightness) podmínek
%%  Model A
%%   mezi dvojící promìnných je podmínka s pravdìpodobností p1
%%   dvojice hodnot v podmínce je nekompatibilní s
%%  pravdìpodobností p2
%%  Model B
%%   je vybráno p1*n*(n-1)/2 náhodných dvojic promìnných mezi
%%  kterými bude podmínka
%%   v ka¾dé podmínce je vybráno p2*m2 náhodných dvojic hodnot,
%%  které budou oznaèeny jako nekompatibilní
%%  Model E
%%   náhodnì je vybráno p1* p2* m2 *n*(n-1)/2 ètveøic <i,hi,j,hj>, kde i a j
%%  jsou promìnné a hi a hj je dvojice nekompatibilních hodnot

\section{Quasigroup With Holes}
Quasigroup (or latin square) is table of size $n \times n$ filled with natural numbers
$\{1,...,n\}$. Every number is unique in row and in column (latin square constraint). 
\zkratka{QWH}{Quasigroup Qith Holes} is former fully filled quasigroup where were $p\%$ 
of values deleted. The empty values are calles holes and the other non-holes. Ballanced 
QHW has evenly distributed non-holes across rows and columns. QWH can be allways solved.

\section{Quasigroup Completion Problem}
\zkratka{QCP}{Quasigroup Completion Problem} consists of empty table where are then filled
$p\%$ values which are consistent with the latin square constraint. The task is to 
fill the table with values so it will form a latin square. QCP does not guarantee 
the task to be sovable. The larger parameter $p$ is the lesser is probability 
that there exists solution.

\chapter{Benchmark results}

\begin{figure}
\begin{center}
\includegraphics[scale=0.1]{images/grafy/100magic.eps}
\end{center}
\end{figure} 

\chapter{Conclusions}
Since there are no results therefore there are not result. Wait for it. 

\appendix
\chapter{List of solvers}
\chapter{SRQ in tested solvers}
\printnomenclature[2.5cm]

%%% Seznam literatury
%%%
%%% Literatura se øadí abecednì. Úvádí se pouze literatura, na kterou se v textu odkazuje.
%%% Pøi odkazu na knihu se v¾dy uvádìjí èísla stránek.

\bibliographystyle{plain}
\bibliography{bc_prototype}


%%\begin{thebibliography}{99}
%%\addcontentsline{toc}{chapter}{References}
%% \bibitem{schulte}SCHULTE, Christian. {\em Programming Constraint Services : High-Level Programming of Standard and New Constraint Services}. Berlin Heidelberg : Springer Verlag, 2002. 176 p. ISBN 3-540-43371-6.
%% \bibitem{eclipse-manual}AGGOUN, Abderrahamane, et al. {\em ECLiPSe : User Manual}. Release 5.10. [s.l.] : [s.n.], 2007. 263 p. Available at WWW: $<$http://eclipse.crosscoreop.com/doc/userman.pdf$>$.  
%%\end{thebibliography}

\end{document}
